# React diff 原理

1. 首先, 因为一般不会出现父节点变到子节点的层级的情况, 所以 diff 算法都是比较同一层级, 就是父节点比较父节点, 子节点比较子节点

2. diff 算法首先会比较新旧节点是否为同一个节点, 就是计较节点的 tagName属性 和 key 属性等

3. 如果不是相同节点就删除重新渲染

4. 是的话就进行新旧节点的对比

5. patchVode()

   - 首先通过旧 节点上的 el 属性 找到对应的真实dom
   - 如果新旧 节点都有文本节点且不相同, 就把真实 dom 的文本节点设置为  新 节点的文本节点
   - 如果旧节点有子节点而新节点没有, 就删除真实
   - 然后如果新节点有子节点而旧节点没有, 就实例化新节点的子节点添加到真实 dom 上
   - 如果两个都有子节点的话, 就调用比较子节点的方法去对比

6. updateChildren() 子节点的对比

   - 首先, 新旧子节点的集合里面各有首尾两个指针, 或者说索引
   - 然后会有五种情况的判断:
     - 新旧开始节点的对比
     - 结束节点的对比
     - 新的开始节点比旧的结束节点
     - 旧的开始节点比新的开始节点
     - 最后, 如果上述情况都不满足, 就遍历所有的旧节点, 把他们的 key 映射到 index索引上, 然后再用新节点的 key 去找到这个 index, 从而找到了能在旧节点复用的位置
     - 最后, 上面所说的开始节点, 结束节点啥的都是相对的, 因为每一次循环之后, 新旧集合的指针都会发生相应变化, 就比如第一种, 如果满足新旧开始节点相同, 那新节点集合和旧节点集合的开始指针都加一, 然后都指向该集合的第二个元素作为下一轮循环的开始节点

7. diff 原理我知道的大概就这些

